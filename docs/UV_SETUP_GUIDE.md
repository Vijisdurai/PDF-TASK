# UV Python Package Manager Setup Guide

## What is UV?

UV is an extremely fast Python package installer and resolver, written in Rust. It's a drop-in replacement for pip and pip-tools, offering:

- **10-100x faster** than pip
- **Deterministic dependency resolution** with lock files
- **Built-in virtual environment management**
- **Python version management**
- **Zero configuration** for most projects

## Installation

### Windows

**Option 1: PowerShell (Recommended)**
```powershell
irm https://astral.sh/uv/install.ps1 | iex
```

**Option 2: pip**
```bash
pip install uv
```

**Option 3: Scoop**
```bash
scoop install uv
```

### Linux/macOS

**Option 1: curl (Recommended)**
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

**Option 2: pip**
```bash
pip install uv
```

**Option 3: Homebrew (macOS)**
```bash
brew install uv
```

## Quick Start

### Automated Setup

**Windows:**
```bash
tools\scripts\setup_uv.bat
```

**Linux/macOS:**
```bash
bash tools/scripts/setup_uv.sh
```

This will:
1. Check if UV is installed
2. Install Python 3.11 if needed
3. Create a virtual environment
4. Install all dependencies

### Manual Setup

1. **Install Python 3.11**
   ```bash
   uv python install 3.11
   ```

2. **Create virtual environment and install dependencies**
   ```bash
   uv sync
   ```

3. **Activate virtual environment**
   
   Windows:
   ```bash
   .venv\Scripts\activate
   ```
   
   Linux/macOS:
   ```bash
   source .venv/bin/activate
   ```

## Common Commands

### Dependency Management

**Add a new dependency:**
```bash
uv add fastapi
```

**Add a dev dependency:**
```bash
uv add --dev pytest
```

**Remove a dependency:**
```bash
uv remove package-name
```

**Update all dependencies:**
```bash
uv sync --upgrade
```

**Install dependencies from pyproject.toml:**
```bash
uv sync
```

### Running Commands

**Run Python script:**
```bash
uv run python modules/main.py
```

**Run tests:**
```bash
uv run pytest
```

**Run with specific Python version:**
```bash
uv run --python 3.11 python modules/main.py
```

### Virtual Environment Management

**Create new virtual environment:**
```bash
uv venv
```

**Create with specific Python version:**
```bash
uv venv --python 3.11
```

**Activate virtual environment:**

Windows:
```bash
.venv\Scripts\activate
```

Linux/macOS:
```bash
source .venv/bin/activate
```

### Python Version Management

**List available Python versions:**
```bash
uv python list
```

**Install specific Python version:**
```bash
uv python install 3.11
```

**Pin Python version for project:**
```bash
uv python pin 3.11
```

## Project Structure

```
/
├── pyproject.toml          # Project configuration and dependencies
├── uv.lock                 # Lock file for reproducible installs
├── .python-version         # Python version specification
├── .venv/                  # Virtual environment (auto-created)
├── modules/                # Backend modules
├── core/                   # Shared core utilities
├── shared/                 # Shared configuration
└── tools/                  # Development tools
    └── scripts/
        ├── setup_uv.bat    # Windows setup script
        └── setup_uv.sh     # Unix setup script
```

## Running the Application

### Using UV (Recommended)

**Windows:**
```bash
run_uv.bat
```

**Linux/macOS:**
```bash
bash run_uv.sh
```

### Manual Run

```bash
uv run python modules/main.py
```

Or with activated virtual environment:
```bash
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/macOS
python modules/main.py
```

## Development Workflow

### 1. Initial Setup
```bash
# Install UV
irm https://astral.sh/uv/install.ps1 | iex  # Windows
curl -LsSf https://astral.sh/uv/install.sh | sh  # Linux/macOS

# Setup project
uv sync
```

### 2. Daily Development
```bash
# Activate environment
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/macOS

# Run development server
uv run python modules/main.py

# Run tests
uv run pytest

# Format code
uv run black .

# Lint code
uv run ruff check .
```

### 3. Adding Dependencies
```bash
# Add runtime dependency
uv add package-name

# Add dev dependency
uv add --dev package-name

# Sync dependencies
uv sync
```

### 4. Updating Dependencies
```bash
# Update all dependencies
uv sync --upgrade

# Update specific package
uv add package-name --upgrade
```

## Configuration Files

### pyproject.toml

Main project configuration file containing:
- Project metadata
- Dependencies
- Dev dependencies
- Tool configurations (black, ruff, mypy, pytest)

### uv.lock

Lock file ensuring reproducible installations. This file:
- Is auto-generated by UV
- Should be committed to version control
- Ensures all team members use exact same dependency versions

### .python-version

Specifies the Python version for the project. UV automatically uses this version when running commands.

## Troubleshooting

### UV not found after installation

**Windows:**
```powershell
# Restart PowerShell or add to PATH manually
$env:Path += ";$env:USERPROFILE\.cargo\bin"
```

**Linux/macOS:**
```bash
# Source shell config
source ~/.bashrc  # or ~/.zshrc
```

### Virtual environment not activating

```bash
# Recreate virtual environment
rm -rf .venv  # Linux/macOS
rmdir /s .venv  # Windows
uv venv
uv sync
```

### Dependency conflicts

```bash
# Clear cache and reinstall
uv cache clean
uv sync --reinstall
```

### Python version issues

```bash
# Install specific Python version
uv python install 3.11

# Pin version for project
uv python pin 3.11

# Verify version
uv run python --version
```

## Migration from pip/venv

If you're migrating from traditional pip/venv setup:

1. **Backup existing environment:**
   ```bash
   pip freeze > old_requirements.txt
   ```

2. **Install UV:**
   ```bash
   pip install uv
   ```

3. **Create pyproject.toml:**
   ```bash
   # Already created in this project
   ```

4. **Sync dependencies:**
   ```bash
   uv sync
   ```

5. **Verify installation:**
   ```bash
   uv run python -c "import fastapi; print('Success!')"
   ```

## Performance Comparison

| Operation | pip | UV | Speedup |
|-----------|-----|-----|---------|
| Install from cache | 5s | 0.1s | 50x |
| Cold install | 30s | 2s | 15x |
| Dependency resolution | 10s | 0.5s | 20x |

## Best Practices

1. **Always use `uv sync`** instead of `pip install -r requirements.txt`
2. **Commit `uv.lock`** to version control
3. **Use `uv add`** instead of manually editing pyproject.toml
4. **Pin Python version** with `.python-version` file
5. **Use `uv run`** for running scripts to ensure correct environment
6. **Keep UV updated:** `uv self update`

## Additional Resources

- [UV Documentation](https://docs.astral.sh/uv/)
- [UV GitHub Repository](https://github.com/astral-sh/uv)
- [UV vs pip Comparison](https://docs.astral.sh/uv/pip/compatibility/)

## Support

For issues or questions:
1. Check the [UV documentation](https://docs.astral.sh/uv/)
2. Search [GitHub issues](https://github.com/astral-sh/uv/issues)
3. Refer to project-specific documentation in `/docs`
